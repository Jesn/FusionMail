---
inclusion: fileMatch
fileMatchPattern: '**/tasks.md'
description: "任务管理完整规范：包含执行标准、文档验证和质量控制"
---

# 任务管理规范

> ⚠️ **重要提醒**：本规范自动应用于所有 `tasks.md` 文件。在执行任何任务前，请务必阅读并遵循以下规范。

## 📋 任务文档标准

### 必需内容检查

每个 `tasks.md` 文件必须包含以下标准章节：

#### 1. 任务状态标记规范
- `[ ]` - 未开始
- `[~]` - 处理中 / 进行中
- `[x]` - 已完成  
- `【该任务暂时先不处理】` - 暂时跳过
- `【暂停】` 或 `【已暂停】` - 已暂停
- `【阻塞】` - 被阻塞

#### 2. 任务描述格式
每个任务必须包含：
- **任务编号**：使用层级编号（如 1.1, 1.2, 2.1）
- **任务标题**：简洁明确的任务描述
- **具体内容**：详细的实施步骤
- **需求引用**：引用相关的需求编号
- **验收标准**：明确的完成标准（可选）

#### 3. 文档质量检查清单
- [ ] 包含完整的任务执行规范章节
- [ ] 所有任务都有明确的状态标记
- [ ] 任务描述格式统一且完整
- [ ] 任务状态管理机制清晰
- [ ] 验证步骤适合项目类型
- [ ] 任务编号和依赖关系清晰

## 🚀 任务执行规范

### 任务选择规则

#### 优先级和状态检查

**⚠️ 重要：** 在领取任务前必须检查任务状态：

- **标注为 `【该任务暂时先不处理】` 的任务必须跳过**，继续处理其他任务
- **标注为 `【暂停】` 或 `【已暂停】` 的任务必须跳过**
- **标注为 `【阻塞】` 的任务需要先解决阻塞问题**
- **标注为 `[~]` 处理中的任务**：检查是否为自己正在处理，如果是他人处理则跳过
- 优先处理当前阶段的未完成任务（`[ ]` 未开始状态）
- 按照模块依赖关系和任务编号顺序执行
- 如果当前阶段所有可处理任务都已完成，可以开始下一阶段

#### 任务执行顺序

1. **阶段内顺序**：按照任务编号（1.1 → 1.2 → 1.3）顺序执行
2. **模块依赖**：遵循模块间的依赖关系
3. **子任务优先**：如果任务有子任务，必须先完成所有子任务
4. **并行限制**：同时只能执行一个任务，避免冲突

### 任务完成验证步骤

**重要说明：** 每个任务完成后必须执行以下验证步骤：

#### 1. 编译验证

#### 2. 测试验证

#### 3. 特定验证（根据项目类型）

#### 4. 代码提交
```bash
# 提交当前文件变更
git add .
git commit -m "<type>[scope]: <description>"
```

**提交消息规范**（遵循 Conventional Commits）：
- `feat`: 新功能 - `feat(core): 添加服务工厂模式`
- `fix`: Bug修复 - `fix(caching): 解决Redis提供程序内存泄漏`
- `refactor`: 重构 - `refactor(storage): 提取Blob提供程序接口`
- `test`: 测试 - `test(events): 为事件总线添加集成测试`
- `docs`: 文档 - `docs(api): 更新服务注册示例`
- `chore`: 构建/工具 - `chore(deps): 更新NuGet包`

#### 5. 任务状态更新

1. **开始任务时**：将任务状态从 `[ ]` 更新为 `[~]` 表示正在处理
2. **完成任务时**：在 tasks.md 中将任务标记为完成 `[x]` 或 ✅
2. **可选记录**：对于重要任务或里程碑，可选择性地在总结文档中添加简单记录：
   - 任务编号和标题
   - 完成时间
   - 主要成果（一句话描述）
   - 验证状态

**简化记录格式**：
```markdown
### 任务X.Y：[任务标题] ✅
**完成**：2024-12-19 | **成果**：[简要描述] | **状态**：✅ 已验证
```

#### 6. 继续条件检查

**只有在步骤1-5都成功后才能继续下一个任务**

## ⚠️ 异常处理

### 任务阻塞处理

如果任务遇到阻塞：

1. **记录阻塞原因**：在任务描述中详细记录阻塞原因
2. **标记任务状态**：将任务标记为 `【阻塞】`
3. **寻求解决方案**：尝试寻找替代方案或寻求帮助
4. **跳过继续**：如果无法立即解决，跳过该任务处理其他任务

### 任务失败处理

如果任务执行失败：

1. **分析失败原因**：详细分析失败的根本原因
2. **回滚变更**：如果必要，回滚到稳定状态
3. **重新规划**：重新评估任务的可行性和方法
4. **寻求帮助**：如果需要，寻求技术支持

## 💡 核心要求

- **编码规范**：严格遵循项目编码标准
- **测试驱动**：优先编写测试，然后实现功能
- **增量提交**：复杂任务进行增量提交
- **文档同步**：及时更新相关文档

## ❓ 常见问题

**Q: 项目特定验证步骤？**  
A: 替换步骤3为实际命令（如 `tools/run-tests.ps1`、SOLID检查等）

**Q: 必须更新总结文档？**  
A: 不必需。必需：更新状态 ✅；可选：重要任务添加一行记录

**Q: 任务阻塞处理？**  
A: 标记 `【阻塞】` → 说明原因 → 跳过处理其他任务

**Q: 处理中状态的使用？**  
A: 开始任务时标记 `[~]` → 完成时更新为 `[x]` → 避免多人同时处理同一任务

---

## 📋 快速检查清单

### 执行前检查
- [ ] 任务状态允许执行（非暂停/阻塞/他人处理中）
- [ ] 理解任务依赖关系
- [ ] 准备好开发环境
- [ ] 将任务状态更新为 `[~]` 处理中

### 执行后检查  
- [ ] 编译通过 → 测试通过 → 提交代码 → 更新状态为 `[x]`
- [ ] 文档格式符合标准
- [ ] 状态标记正确更新